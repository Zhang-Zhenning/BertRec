
Probabilistic Ranking Principle

Hongning Wang

CS@UVa


Notion of relevance

CS 4780: Information Retrieval

Relevance

D(Rep(q), Rep(d))    

Similarity

P(r=1|q,d)   r Ã{0,1}

Probability of Relevance

P(d Â®q) or P(q Â®d)

Probabilistic inference

Different 

rep &amp; similarity

Vector space

model

(Salton et al., 75)

Prob. distr.

model

(Wong &amp; Yao, 89)

â€¦

Generative Model

Regression

Model

(Fox 83)

Classical

prob. Model

(Robertson &amp; 

Sparck Jones, 76)

Doc

generation

Query

generation

LM

approach

(Ponte &amp; Croft, 98)

(Lafferty &amp; Zhai, 01a)

Prob. concept

space model

(Wong &amp; Yao, 95)

Different inference system

Inference 

network

model

(Turtle &amp; Croft, 91)

Todayâ€™s lecture

CS@UVa

2


Basic concepts in probability 

â€¢ Random experiment 

â€“ An experiment with uncertain outcome (e.g., tossing a coin, picking a 

word from text)

â€¢ Sample space (S)

â€“ All possible outcomes of an experiment, e.g., tossing 2 fair 

coins, S={HH, HT, TH, TT}

â€¢ Event (E)

â€“ EÃS, E happens iff outcome is in S, e.g., E={HH} (all heads), 

E={HH,TT} (same face)

â€“ Impossible event ({}), certain event (S)

â€¢ Probability of event

â€“ 0 â‰¤ P(E) â‰¤ 1

CS 4780: Information Retrieval

CS@UVa

3


Essential probability concepts

â€¢ Probability of events

â€“ Mutually exclusive events

â€¢ ğ‘ƒ ğ´ âˆª ğµ = ğ‘ƒ ğ´ + ğ‘ƒ(ğµ)

â€“ General events

â€¢ ğ‘ƒ ğ´ âˆª ğµ = ğ‘ƒ ğ´ + ğ‘ƒ ğµ âˆ’ ğ‘ƒ(ğ´ âˆ© ğµ)

â€“ Independent events

â€¢ ğ‘ƒ ğ´ âˆ© ğµ = ğ‘ƒ ğ´ ğ‘ƒ ğµ

CS 4780: Information Retrieval

Joint probability, or 

simply as ğ‘ƒ(ğ´, ğµ)

CS@UVa

4


Essential probability concepts

CS 4780: Information Retrieval

â€¢ Conditional probability

â€“ ğ‘ƒ ğµ ğ´ = ğ‘ƒ(ğ´, ğµ)/ğ‘ƒ ğ´

â€“ Bayesâ€™ Rule: ğ‘ƒ ğµ ğ´ = ğ‘ƒ ğ´ ğµ ğ‘ƒ(ğµ)/ğ‘ƒ ğ´

â€“ For independent events, ğ‘ƒ ğµ ğ´ = ğ‘ƒ(ğµ)

â€¢ Total probability

â€“ If ğ´1, â€¦ , ğ´) form a non-overlapping partition of S

â€¢ ğ‘ƒ(ğµÃ‡ğ‘†) = ğ‘ƒ(ğµÃ‡ğ´1) + â‹¯ + ğ‘ƒ(ğµÃ‡ğ´!)

â€¢ ğ‘ƒ ğ´ğ‘– ğµ =

! ğµ ğ´ğ‘– ! "!

! ğµ ğ´1 ! "" #â‹¯#! ğµ ğ´ğ‘› ! "# âˆ ğ‘ƒ ğµ ğ´% ğ‘ƒ(ğ´%)

â€¢ This allows us to compute ğ‘ƒ(ğ´ğ‘–|ğµ) based on ğ‘ƒ(ğµ|ğ´%)

CS@UVa

5


Interpretation of Bayesâ€™ rule

)

(

)

|

(

)

|

(

i

i

i

H

P

H

E

P

E

H

P

Âµ

CS 4780: Information Retrieval

Hypothesis space: ğ» = {ğ»1, â€¦ , ğ»ğ‘›},     Evidence: ğ¸

If we want to pick the most likely hypothesis H*,  we can drop ğ‘ƒ(ğ¸)

Posterior probability of ğ‘¯ğ’Š

Prior probability of ğ‘¯ğ’Š

Likelihood of data/evidence given ğ‘¯ğ’Š

ğ‘ƒ ğ»" ğ¸ = ğ‘ƒ ğ¸ ğ»" ğ‘ƒ(ğ»")

ğ‘ƒ(ğ¸)

CS@UVa

6


Theoretical justification of ranking

â€¢ As stated by William Cooper

â€“ Rank by probability of relevance leads to the 

optimal retrieval effectiveness

CS 4780: Information Retrieval

â€œIf a reference retrieval systemâ€™s response to each request is a ranking of the 

documents in the collections in order of decreasing probability of 

usefulness to the user who submitted the request, where the probabilities are 

estimated as accurately as possible on the basis of whatever data made 

available to the system for this purpose, then the overall effectiveness of the 

system to its users will be the best that is obtainable on the basis of that 

data.â€

CS@UVa

7


Justification

â€¢ From decision theory

â€“ Two types of loss

â€¢ Loss(retrieved|non-relevant)=ğ‘#

â€¢ Loss(not retrieved|relevant)=ğ‘$

â€“ ğœ™(ğ‘‘,, ğ‘): probability of ğ‘‘, being relevant to ğ‘

â€“ Expected loss regarding to the decision of 

including ğ‘‘, in the final results

â€¢ Retrieve: 1 âˆ’ ğœ™ ğ‘‘", ğ‘

ğ‘#

â€¢ Not retrieve: ğœ™ ğ‘‘", ğ‘ ğ‘$

CS 4780: Information Retrieval

Your decision criterion?

CS@UVa

8


Justification

â€¢ From decision theory

â€“ We make decision by

â€¢ If 1 âˆ’ ğœ™ ğ‘‘", ğ‘

ğ‘#&lt;ğœ™ ğ‘‘", ğ‘ ğ‘$, retrieve ğ‘‘"

â€¢ Otherwise, not retrieve ğ‘‘"

â€“ Check if ğœ™ ğ‘‘,, ğ‘ &gt;

-!

-!.-"

â€“ Rank documents by descending order of ğœ™ ğ‘‘,, ğ‘

would minimize the loss

CS 4780: Information Retrieval

CS@UVa

9

Pop-up Quiz: Can you prove it?  


According to PRP, what we need is

â€¢ A relevance measure function F(q,d) 

â€“ For all q, d1, d2,  

F(q,d1) &gt; F(q,d2) iff. p(Rel|q,d1) &gt;p(Rel|q,d2)

â€“ Assumptions

â€¢ Independent relevance 

â€¢ Independent loss

â€¢ Sequential browsing

CS 4780: Information Retrieval

Most existing research on IR models so far has fallen into 

this line of thinkingâ€¦ (Limitations?) 

CS@UVa

10


Probability of relevance

â€¢ Three random variables

â€“ Query Q

â€“ Document D

â€“ Relevance R Ã {0,1}

â€¢ Goal: rank D based on P(R=1|Q,D)

â€“ Compute P(R=1|Q,D)

â€“ Actually, one only needs to compare P(R=1|Q,D1) 

with P(R=1|Q,D2), i.e., rank documents

â€¢ Several different ways to define P(R=1|Q,D) 

CS 4780: Information Retrieval

CS@UVa

11


Conditional models for P(R=1|Q,D) 

â€¢ Basic idea: relevance depends on how well a 

query matches a document

â€“ P(R=1|Q,D)=g(Rep(Q,D),q)

â€¢ Rep(Q,D): feature representation of query-doc pair

â€“ E.g., #matched terms, highest IDF of a matched term, docLen

â€“ Using training data (with known relevance 

judgments) to estimate parameter q

â€“ Apply the model to rank new documents

â€¢ Special case: logistic regression

CS 4780: Information Retrieval

a functional form

CS@UVa

12


Regression for ranking?

â€¢ Linear regression

â€“ ğ‘¦ â† ğ‘¤/ğ‘‹

â€“ Relationship between a scalar dependent variable 

ğ‘¦ and one or more explanatory variables

CS 4780: Information Retrieval



In a ranking problem:

ğ‘‹ features about query-document pair

ğ‘¦ relevance label of document for the given query

CS@UVa

13


Features/Attributes for ranking

â€¢ Typical features considered in ranking 

problems

M

X

n

n

N

M

X

DL

X

DAF

M

X

QL

X

QAF

M

X

M

t

t

M

t

M

t

j

j

j

j

log

log

1

log

1

log

1

6

1

5

4

1

3

2

1

1

=

-

=

=

=

=

=

Ã¥

Ã¥

Ã¥

Average Absolute Query Frequency

Query Length

Average Absolute Document Frequency

Document Length

Average Inverse Document Frequency

Number of Terms in common between 

query and document 

CS 4780: Information Retrieval

CS@UVa

14


Regression for ranking

â€¢ Linear regression

â€“ ğ‘¦ â† ğ‘¤/ğ‘‹

â€“ Relationship between a scalar dependent variable 

ğ‘¦ and one or more explanatory variables

CS 4780: Information Retrieval

Optimal 

regression model

x

y

Y is discrete in a ranking 

problem!

What if we have 

an outlier? 

1.00

0.50

0.25

0.00

0.75

CS@UVa

15


Regression for ranking

â€¢ Logistic regression

â€“ P(R=1|Q,D) = ğœ ğ‘¤/ğ‘‹ =

0

0.123(45#6)

â€“ Directly modeling posterior of document 

relevance

CS 4780: Information Retrieval

x

P(y|x)

1.00

0.50

0.25

0.00

0.75

What if we have 

an outlier? 

Sigmoid function

CS@UVa

16


Conditional models for P(R=1|Q,D)

Pros &amp; Cons

â€¢ Advantages

â€“ Absolute probability of relevance available

â€“ May re-use all the past relevance judgments

â€¢ Problems

â€“ Performance heavily depends on the selection of 

features

â€“ Little guidance on feature selection

â€¢ Will be covered with more details in later 

learning-to-rank discussions

CS 4780: Information Retrieval

CS@UVa

17


Recap: TF-IDF weighting

â€¢ Combining TF and IDF 

â€“ Common in doc Ã  high tf Ã  high weight

â€“ Rare in collectionÃ  high idfÃ  high weight

â€“ ğ‘¤ ğ‘¡, ğ‘‘ = ğ‘‡ğ¹ ğ‘¡, ğ‘‘ Ã—ğ¼ğ·ğ¹(ğ‘¡)

â€¢ Most well-known document representation 

schema in IR! (G Salton et al. 1983)



â€œSalton was perhaps the 

leading computer scientist 

working in the field of 

information retrieval during his 

time.â€ - wikipedia

Gerard Salton Award

â€“ highest achievement award in IR

CS@UVa

CS 4780: Information Retrieval

18


Recap: probabilistic ranking principle

â€¢ From decision theory

â€“ We make decision by

â€¢ If 1 âˆ’ ğœ™ ğ‘‘", ğ‘

ğ‘#&lt;ğœ™ ğ‘‘", ğ‘ ğ‘$, retrieve ğ‘‘"

â€¢ Otherwise, not retrieve ğ‘‘"

â€“ Check if ğœ™ ğ‘‘,, ğ‘ &gt;

-!

-!.-"

â€“ Rank documents by descending order of ğœ™ ğ‘‘,, ğ‘

would minimize the loss

CS 4780: Information Retrieval

CS@UVa

19


Recap: conditional models for 

P(R=1|Q,D) 

â€¢ Basic idea: relevance depends on how well a 

query matches a document

â€“ P(R=1|Q,D)=g(Rep(Q,D),q)

â€¢ Rep(Q,D): feature representation of query-doc pair

â€“ E.g., #matched terms, highest IDF of a matched term, docLen

â€“ Using training data (with known relevance 

judgments) to estimate parameter q

â€“ Apply the model to rank new documents

â€¢ Special case: logistic regression

CS 4780: Information Retrieval

a functional form

CS@UVa

20


Generative models for P(R=1|Q,D)

â€¢ Basic idea

â€“ Compute Odd(R=1|Q,D) using Bayesâ€™ rule

â€¢ Assumption

â€“ Relevance is a binary variable

â€¢ Variants

â€“ Document â€œgenerationâ€

â€¢ P(Q,D|R)=P(D|Q,R)P(Q|R)

â€“ Query â€œgenerationâ€

â€¢ P(Q,D|R)=P(Q|D,R)P(D|R)

CS 4780: Information Retrieval

)

0

(

)1

(

)

0

|

,

(

)1

|

,

(

)

,

|

0

(

)

,

|1

(

)

,

|1

(

=

=

=

=

=

=

=

=

=

R

P

R

P

R

D

Q

P

R

D

Q

P

D

Q

R

P

D

Q

R

P

D

Q

R

Odd

Ignored for ranking

CS@UVa

21


Document generation model

CS 4780: Information Retrieval

)

0

,

|

(

)1

,

|

(

)

0

|

(

)

0

,

|

(

)1

|

(

)1

,

|

(

)

0

|

,

(

)1

|

,

(

)

,

|1

(

=

=

Âµ

=

=

=

=

=

=

=

Âµ

=

R

Q

D

P

R

Q

D

P

R

Q

P

R

Q

D

P

R

Q

P

R

Q

D

P

R

D

Q

P

R

D

Q

P

D

Q

R

Odd

Model of relevant docs for Q

Model of non-relevant docs for Q

Assume independent attributes of A1â€¦Ak â€¦.(why?)

Let D=d1â€¦dk, where dk Ã{0,1} is the value of attribute Ak (Similarly Q=q1â€¦qk )

Ã•

Ã•

Ã•

=

=

=

=

=

=

=

=

=

=

=

=

=

=

=

=

=

=

Âµ

=

k

d

i

i

i

k

d

i

i

i

k

i

i

i

i

i

i

i

R

Q

A

P

R

Q

A

P

R

Q

A

P

R

Q

A

P

R

Q

d

A

P

R

Q

d

A

P

D

Q

R

Odd

0

,1

1

,1

1

)

0

,

|

0

(

)1

,

|

0

(

)

0

,

|1

(

)1

,

|1

(

)

0

,

|

(

)1

,

|

(

)

,

|1

(

Terms occur in doc

Terms do not occur in doc

document

relevant(R=1)

nonrelevant(R=0)

term present Ai=1

pi

ui

term absent  Ai=0

1-pi

1-ui

Ignored for ranking

information

retrieval

retrieved

is

helpful

for 

you

everyone

Doc1

1

1

0

1

1

1

0

1

Doc2

1

0

1

1

1

1

1

0

CS@UVa

22


Document generation model

CS 4780: Information Retrieval

Ã•

Ã•

Ã•

Ã•

Ã•

Ã•

Ã•

=

=

=

=

=

=

=

=

=

=

=

=

=

=

=

=

-

-

-

-

=

-

-

Â»

=

=

=

=

=

=

=

=

=

=

=

=

=

Âµ

=

k

q

i

i

i

k

q

d

i

i

i

i

i

k

q

d

i

i

i

k

q

d

i

i

i

k

d

i

i

i

k

d

i

i

i

k

i

i

i

i

i

i

i

i

i

i

i

i

i

i

u

p

p

u

u

p

u

p

u

p

R

Q

A

P

R

Q

A

P

R

Q

A

P

R

Q

A

P

R

Q

d

A

P

R

Q

d

A

P

D

Q

R

Odd

1

,1

1

,1

1

,0

,1

1

,1

0

,1

1

,1

1

1

1

)

1(

)

1(

1

1

)

0

,

|

0

(

)1

,

|

0

(

)

0

,

|1

(

)1

,

|1

(

)

0

,

|

(

)1

,

|

(

)

,

|1

(

Terms occur in doc

Terms do not occur in doc

document

relevant(R=1)

nonrelevant(R=0)

term present Ai=1

pi

ui

term absent  Ai=0

1-pi

1-ui

Assumption: terms not occurring in 

the query are equally likely to 

occur in relevant and nonrelevant

documents, i.e., pt=ut

Important tricks

CS@UVa

23


Robertson-Sparck Jones Model

(Robertson &amp; Sparck Jones 76)

CS 4780: Information Retrieval

Two parameters for each term Ai: 

pi = P(Ai=1|Q,R=1): prob. that term Ai occurs in a relevant doc   

ui = P(Ai=1|Q,R=0): prob. that term Ai occurs in a non-relevant doc  

Ã¥

Ã¥

Â»

=

=

=

=

=

=

-

+

-

=

-

-

=

k

q

d

i

i

i

i

i

k

q

d

i

i

i

i

i

Rank

i

i

i

i

u

u

p

p

p

u

u

p

D

Q

R

O

1

,1

1

,1

1

log

1

log

)

1(

)

1(

log

)

,

|1

(

log

(RSJ model) 

How to estimate these parameters?

1

)

.

(

#

5.0

)

.

(

#

Ë†

1

)

.

(

#

5.0

)

.

(

#

Ë†

+

+

=

+

+

=

doc

nonrel

A

with

doc

nonrel

u

doc

rel

A

with

doc

rel

p

i

i

i

i

â€¢

â€œ+0.5â€ and â€œ+1â€ can be justified by Bayesian estimation as priors 

CS@UVa

24

Suppose we have relevance judgments,


Parameter estimation

â€¢ General setting:

â€“ Given a (hypothesized &amp; probabilistic) model that 

governs the random experiment

â€“ The model gives probability of any data ğ‘(ğ·|ğœƒ) that 

depends on the parameter ğœƒ

â€“ Now, given actual sample data X={x1,â€¦,xn},  what can 

we say about the value of ğœƒ?

â€¢ Intuitively, take our best guess of ğœƒ -- â€œbestâ€ 

means â€œbest explaining/fitting the dataâ€

â€¢ Generally an optimization problem

CS 4780: Information Retrieval

CS@UVa

25


Maximum likelihood vs. Bayesian

â€¢ Maximum likelihood estimation

â€“ â€œBestâ€ means â€œdata likelihood reaches maximumâ€

â€“ Issue: small sample size

â€¢ Bayesian estimation 

â€“ â€œBestâ€ means being consistent with our â€œpriorâ€ 

knowledge and explaining data well

â€“ A.k.a, Maximum a Posterior estimation

â€“ Issue: how to define prior?

CS 4780: Information Retrieval

7ğœ½ = ğšğ«ğ ğ¦ğšğ±ğœ½ğ(ğ—|ğœ½)

7ğœ½ = ğšğ«ğ ğ¦ğšğ±ğœ½ğ‘· ğœ½ ğ‘¿ = ğšğ«ğ ğ¦ğšğ±ğœ½ğ ğ— ğœ½ ğ(ğœ½)

ML: Frequentistâ€™s point of view

MAP: Bayesianâ€™s point of view

CS@UVa

26


Illustration of Bayesian estimation

CS 4780: Information Retrieval

Prior: p(q)

Likelihood:

p(X|q) X=(x1,â€¦,xN)

Posterior:

p(q|X)Âµ p(X|q)p(q)

q

qa: prior mode 

qml: ML estimate

q: posterior mode 

CS@UVa

27


Maximum likelihood estimation

â€¢ Data: a document d with counts c(w1), â€¦, c(wN)

â€¢ Model: multinomial distribution p(ğ‘Š|ğœƒ) with parameters 

ğœƒ" = ğ‘(ğ‘¤")

â€¢ Maximum likelihood estimator: Hğœƒ = ğ‘ğ‘Ÿğ‘”ğ‘šğ‘ğ‘¥(ğ‘(ğ‘Š|ğœƒ)

CS 4780: Information Retrieval

Using Lagrange multiplier approach, 

weâ€™ll tune ğœ½ğ’Š to maximize ğ‘³(ğ‘¾, ğœ½)

Set partial derivatives to zero

ML estimate

ğ‘ ğ‘Š ğœƒ =

ğ‘

ğ‘ ğ‘¤% , â€¦ , ğ‘(ğ‘¤&amp;) 6

'(%

&amp;

ğœƒ'

)(+") âˆ 6

'(%

&amp;

ğœƒ'

)(+")

log ğ‘ ğ‘Š ğœƒ = ;

'(%

&amp;

ğ‘ ğ‘¤' log ğœƒ'

ğ¿ ğ‘Š, ğœƒ = ;

'(%

&amp;

ğ‘ ğ‘¤' log ğœƒ' + ğœ† ;

'(%

&amp;

ğœƒ' âˆ’ 1

ğœ•ğ¿

ğœ•ğœƒ'

= ğ‘ ğ‘¤'

ğœƒ'

+ ğœ†

â†’ ğœƒ' = âˆ’ ğ‘ ğ‘¤'

ğœ†

âˆ‘'(%

&amp;

ğœƒ'=1

ğœ† = âˆ’ ;

'(%

&amp;

ğ‘ ğ‘¤'

Since

we have 

ğœƒ' =

ğ‘ ğ‘¤'

âˆ‘'(%

&amp;

ğ‘ ğ‘¤'

Requirement from probability



information

20%

retrieval

10%

computer

30%

science

31%

relevant

1%

literature

8%

information

retrieval

computer

science

relevant

literature



CS@UVa

28


Robertson-Sparck Jones Model

(Robertson &amp; Sparck Jones 76)

CS 4780: Information Retrieval

Two parameters for each term Ai: 

pi = P(Ai=1|Q,R=1): prob. that term Ai occurs in a relevant doc   

ui = P(Ai=1|Q,R=0): prob. that term Ai occurs in a non-relevant doc  

Ã¥

Ã¥

Â»

=

=

=

=

=

=

-

+

-

=

-

-

=

k

q

d

i

i

i

i

i

k

q

d

i

i

i

i

i

Rank

i

i

i

i

u

u

p

p

p

u

u

p

D

Q

R

O

1

,1

1

,1

1

log

1

log

)

1(

)

1(

log

)

,

|1

(

log

(RSJ model) 

How to estimate these parameters?

Suppose we have relevance judgments,

1

)

.

(

#

5.0

)

.

(

#

Ë†

1

)

.

(

#

5.0

)

.

(

#

Ë†

+

+

=

+

+

=

doc

nonrel

A

with

doc

nonrel

u

doc

rel

A

with

doc

rel

p

i

i

i

i

â€¢

â€œ+0.5â€ and â€œ+1â€ can be justified by Bayesian estimation as priors 

Per-query estimation!

CS@UVa

29


RSJ Model without relevance info

(Croft &amp; Harper 79)

CS 4780: Information Retrieval

Suppose we do not have relevance judgments,

- We will assume pi to be a constant 

- Estimate ui by assuming all documents to be non-relevant

Ã¥

=

=

=

+

+

-

+

Â»

=

k

q

d

i

i

i

Rank

i

i

n

n

N

c

D

Q

R

O

1

,1

5.0

5.0

log

)

,

|1

(

log

N: # documents in collection

ni: # documents in which term Ai occurs

(RSJ model) 

Ã¥

Ã¥

Â»

=

=

=

=

=

=

-

+

-

=

-

-

=

k

q

d

i

i

i

i

i

k

q

d

i

i

i

i

i

Rank

i

i

i

i

u

u

p

p

p

u

u

p

D

Q

R

O

1

,1

1

,1

1

log

1

log

)

1(

)

1(

log

)

,

|1

(

log

IDF weighted Boolean model?

in

N

IDF

log

1+

=

Reminder:

information

retrieval

retrieved

is

helpful

for 

you

everyone

Doc1

1

1

0

1

1

1

0

1

Doc2

1

0

1

1

1

1

1

0

CS@UVa

30


RSJ Model: summary

â€¢ The most important classical probabilistic IR 

model

â€¢ Use only term presence/absence, thus also 

referred to as Binary Independence Model

â€“ Essentially NaÃ¯ve Bayes for doc ranking

â€“ Designed for short catalog records

â€¢ When without relevance judgments, the model 

parameters must be estimated in an ad-hoc way

â€¢ Performance isnâ€™t as good as tuned VS models

CS 4780: Information Retrieval

CS@UVa

31


Improving RSJ: adding TF 

CS 4780: Information Retrieval

Let D=d1â€¦dk, where dk is the frequency count of term  Ak

Ã•

Ã•

Ã•

Ã•

Â³

=

=

=

Â³

=

=

=

=

=

=

=

=

=

=

Âµ

=

=

=

=

=

=

=

=

=

=

=

=

=

Âµ

=

=

k

d

i

i

i

i

i

i

i

k

d

i

i

i

k

d

i

i

i

i

i

k

i

i

i

i

i

i

i

i

R

Q

A

P

R

Q

d

A

P

R

Q

A

P

R

Q

d

A

P

R

Q

A

P

R

Q

A

P

R

Q

d

A

P

R

Q

d

A

P

R

Q

d

A

P

R

Q

d

A

P

D

Q

R

P

D

Q

R

P

1

,1

0

,1

1

,1

1

)1

,

|

0

(

)

0

,

|

(

)

0

,

|

0

(

)1

,

|

(

)

0

,

|

0

(

)1

,

|

0

(

)

0

,

|

(

)1

,

|

(

)

0

,

|

(

)1

,

|

(

)

,

|

0

(

)

,

|1

(

E

E

e

f

R

Q

E

P

e

f

R

Q

E

p

E

f

A

p

R

Q

E

P

E

f

A

p

R

Q

E

p

R

Q

f

A

p

f

E

i

f

E

i

i

i

i

i

i

Âµ

Âµ

Âµ

Âµ

-

-

+

=

=

+

=

=

=

!

)

,

|

(

!

)

,

|

(

)

|

(

)

,

|

(

)

|

(

)

,

|

(

)

,

|

(

2-Poisson mixture model for TF

Many more parameters to estimate! 

Compound with document length!

Eliteness: if the term is about 

the concept asked in the query

CS@UVa

32


BM25/Okapi approximation

(Robertson et al. 94)

â€¢ Idea: model p(D|Q,R) with a simpler function 

that approximates 2-Possion mixture model

â€¢ Observations:

â€“ log O(R=1|Q,D) is a sum of term weights occurring 

in both query and document

â€“ Term weight Wi= 0, if TFi=0

â€“ Wi increases monotonically with TFi

â€“ Wi has an asymptotic limit

â€¢ The simple function is 

CS 4780: Information Retrieval

)

1(

)

1(

log

)1

( 1

i

i

i

i

i

i

i

p

u

u

p

TF

K

k

TF

W

-

-

+

+

=

Ã•

Â³

=

=

=

=

=

=

=

=

=

Âµ

=

=

k

d

i

i

i

i

i

i

i

i

R

Q

A

P

R

Q

d

A

P

R

Q

A

P

R

Q

d

A

P

D

Q

R

P

D

Q

R

P

1

,1

)1

,

|

0

(

)

0

,

|

(

)

0

,

|

0

(

)1

,

|

(

)

,

|

0

(

)

,

|1

(

CS@UVa

33


Adding doc. length

â€¢ Incorporating doc length

â€“ Motivation: the 2-Poisson model assumes equal 

document length

â€“ Implementation: penalize long doc

â€¢

CS 4780: Information Retrieval

)

1(

)

1(

log

)1

( 1

i

i

i

i

i

i

i

p

u

u

p

TF

K

k

TF

W

-

-

+

+

=

)|

|

|

|

)

1

((

1

d

avg

d

b

b

k

K

Â´

+

-

=

where

Pivoted document length 

normalization

CS@UVa

34


Adding query TF

â€¢ Incorporating query TF

â€“ Motivation

â€¢ Natural symmetry between document and query

â€“ Implementation: a similar TF transformation as in 

document TF

â€¢ The final formula is called BM25, achieving top 

TREC performance

CS 4780: Information Retrieval

)

1(

)

1(

log

)1

(

)1

(

1

i

i

i

i

i

i

i

s

s

i

i

p

u

u

p

TF

K

k

TF

QTF

k

k

QTF

W

-

-

+

+

+

+

=

BM: best match

CS@UVa

35


The BM25 formula 

CS 4780: Information Retrieval



â€œOkapi TF/BM25 TFâ€

becomes IDF when no 

relevance info is available

CS@UVa

36


The BM25 formula 

â€¢ A closer look

â€“ ğ‘ is usually set to [0.75, 1.2]

â€“ ğ‘˜0is usually set to [1.2, 2.0]

â€“ ğ‘˜7 is usually set to (0, 1000]

CS 4780: Information Retrieval

i

i

i

i

n

i

i

qtf

k

k

qtf

D

avg

D

b

b

k

tf

k

tf

q

IDF

D

q

rel

+

+

+

-

+

+

=Ã¥

=

2

2

1

1

1

)1

(

)|

|

|

|

1(

)1

(

)

(

)

,

(

TF-IDF component for document

TF component for query

Vector space model 

with TF-IDF schema!

CS@UVa

37


Extensions of â€œDoc Generationâ€ models

â€¢ Capture term dependence [Rijsbergen &amp; Harper 78]

â€¢ Alternative ways to incorporate TF [Croft 83, Kalt96]

â€¢ Feature/term selection for feedback [Okapiâ€™s TREC 

reports]

â€¢ Estimate of the relevance model based on 

pseudo feedback [Lavrenko &amp; Croft 01]

CS 4780: Information Retrieval

to be covered later  

CS@UVa

38


Query generation models

CS 4780: Information Retrieval

))

0

|

(

)

0

,

|

(

(

)

0

|

(

)

1

|

(

)

1

,

|

(

)

0

|

(

)

0

,

|

(

)

1

|

(

)

1

,

|

(

)

0

|

,

(

)

1

|

,

(

)

,

|

1

(

=

Â»

=

=

=

=

Âµ

=

=

=

=

=

=

=

Âµ

=

R

Q

P

R

D

Q

P

Assume

R

D

P

R

D

P

R

D

Q

P

R

D

P

R

D

Q

P

R

D

P

R

D

Q

P

R

D

Q

P

R

D

Q

P

D

Q

R

O

Assuming uniform document prior, we have

)

1

,

|

(

)

,

|

1

(

=

Âµ

=

R

D

Q

P

D

Q

R

O

Now, the question is how to compute                            ?

)

1

,

|

(

=

R

D

Q

P

Generally involves two steps:

(1) estimate a language model based on D

(2) compute the query likelihood according to the estimated model

Language models, we will cover it in the next lecture!

Query likelihood p(q| qd)

Document prior

CS@UVa

39


What you should know

â€¢ Essential concepts in probability

â€¢ Justification of ranking by relevance

â€¢ Derivation of RSJ model

â€¢ Maximum likelihood estimation

â€¢ BM25 formula

CS 4780: Information Retrieval

CS@UVa

40


Todayâ€™s reading

â€¢ Chapter 11. Probabilistic information retrieval

â€“ 11.2 The Probability Ranking Principle

â€“ 11.3 The Binary Independence Model

â€“ 11.4.3 Okapi BM25: a non-binary model

CS 4780: Information Retrieval

CS@UVa

41

